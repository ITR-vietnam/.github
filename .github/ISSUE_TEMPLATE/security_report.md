name: "Security Vulnerability Detected"
description: "An automatic issue created by a security scanner."
title: "[SECURITY] Vulnerability: {{VULNERABILITY_ID}}"
labels: ["security", "vulnerability", "auto-generated"]
assignees: ["devops"]

body:
  - type: markdown
    attributes:
      value: |
        **IMPORTANCE** Please do not disclose security vulnerabilities publicly. 
        **This issue was automatically generated by a security scan.**  
        Please review and address the reported vulnerability.

  - type: input
    id: vulnerability_id
    attributes:
      label: "Vulnerability ID"
      description: "The unique identifier for the vulnerability (e.g., CVE-2023-XXXX)."
      placeholder: "{{VULNERABILITY_ID}}"
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: "Severity Level"
      description: "Severity rating of the vulnerability."
      options:
        - "Low"
        - "Medium"
        - "High"
        - "Critical"
      default: 2
    validations:
      required: true

  - type: textarea
    id: affected_package
    attributes:
      label: "Affected Package"
      description: "The package, dependency, or component affected."
      placeholder: "{{AFFECTED_PACKAGE}}"
    validations:
      required: true

  - type: input
    id: installed_and_fix_version
    attributes:
      label: "Install / Fix Version"
      description: "Install / Fix version"
      placeholder: "{{AFFECTED_VERSION}}"
    validations:
      required: true

  - type: input
    id: creation_time
    attributes:
      label: "Creation time"
      description: "Creation time of issues."
      placeholder: "{{CREATION_TIME}}"
    validations:
      required: true

  - type: textarea
    id: risk
    attributes:
      label: "Potential Risk"
      description: "The impact if this vulnerability is exploited, this cloud allow attacker to ..."
      placeholder: "{{IMPACT_DESCRIPTION}}"
    validations:
      required: false

  - type: textarea
    id: remediation
    attributes:
      label: "Suggested Remediation"
      description: "Recommended steps to fix the issue."
      placeholder: "{{SUGGESTED_FIX}}"
    validations:
      required: false

  - type: markdown
    id: description
    attributes:
      value: |
        <details>
        <summary>ðŸ“Œ **Vulnerability Description (Click to Expand)**</summary>
        - **Description:** {{VULNERABILITY_DESCRIPTION}}  
        </details>
    validations:
      require: false

  - type: textarea
    id: references
    attributes:
      label: "References"
      description: "Links to CVEs, advisories, or documentation."
      placeholder: "{{REFERENCES}}"
    validations:
      required: false